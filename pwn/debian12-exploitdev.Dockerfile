## Debian 12, **glibc 2.35**
## Tools: pwndbg, pwntools, gdb, build-essential
FROM debian12-base:latest
ENV LANG=en_US.UTF-8
ENV LANGUAGE=en_US:en
ENV LC_ALL=en_US.UTF-8

# go back to root to simplify next few steps
USER root

# install dependencies: build deps, python3.10 deps, basic utils
RUN apt-get update && apt-get install -y --no-install-recommends \
    build-essential \
    curl \
    wget \
    gdb \
    sudo \
    bear \
    tmux \
    file \
    procps \
    python3 \
    python3-dev \
    ca-certificates \
    vim \
    libffi-dev \
    zlib1g-dev

# install pwndbg
RUN curl -qsLk 'https://install.pwndbg.re' -o /opt/pwndbg.sh \
    && chmod +x /opt/pwndbg.sh \
    && bash /opt/pwndbg.sh -t pwndbg-gdb

# install pwntools
ADD ./shared/pwntools.sh /opt/pwntools.sh
RUN /opt/pwntools.sh

# clean up caches after install steps/scripts run
RUN apt-get clean && rm -rf /var/lib/apt/lists/*

USER user
VOLUME [ "/home/user/src" ]
WORKDIR /home/user/src

RUN echo "export PATH=$HOME/.local/bin:$PATH" >> /home/user/.bashrc
ENTRYPOINT [ "/bin/bash" ]

